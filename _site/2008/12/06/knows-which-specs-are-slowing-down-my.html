<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
   <meta http-equiv="content-type" content="text/html; charset=utf-8" />
   <title>Alex Rothenberg - Knows which specs are slowing down my spec suite</title>
   <meta name="author" content="Alex Rothenberg" />
   <link rel="alternate" type="application/atom+xml" title="Alex Rothenberg - feed" href="http://feeds2.feedburner.com/alexrothenberg">
   <link rel="stylesheet" href="/stylesheets/master.css" type="text/css" media="screen" charset="utf-8"/>
   <link rel="stylesheet" href="/stylesheets/vibrant_ink.css" type="text/css" media="screen" charset="utf-8"/>
   <script src="/javascripts/jquery.js" type="text/javascript" charset="utf-8"></script>
   <script src="/javascripts/jquery.github.js" type="text/javascript" charset="utf-8"></script>
   <link href="http://feeds.feedburner.com/alexrothenberg" rel="alternate" title="Alex Rothenberg" type="application/atom+xml" />
</head>
<body>

<div id="site">
  <div id="header">
    <h1>AlexRothenberg</h1>
    <div id="menu">
      <a href="/index.html" id="blog_link">Blog Articles</a>
      <a href="/open_source.html" id="github_link">Open Source</a>
      <a href="/about_me.html" id="about_me">About Me</a>
    </div>
  </div>
  <div class="clearfix"/>
  
  <div id="content">
    <div class="post">
  <h1>Knows which specs are slowing down my spec suite</h1>
  <div class="date">December 06, 2008</div>
  <div class="body">
  <p>
  I often watch my specs run with the ........'s marching across my terminal and sometimes it seems to pause as it hits a particularly slow one. I figure there's some poorly written spec that's slowing my entire suite down and I <span style="font-style:italic;">should</span> figure out what it is and fix it. But I rarely (if ever) take the time to track down the offender so never fix it. I just discovered that the clever folks writing rspec have taken away my excuse for laziness. I can tell it to report on the slowest specs by putting a line in my spec.opts file telling it to use the ProfileFormatter (see the first line below)<br>
  <br>
</p>
<pre class="old_code">
<br>--format profile<br>--colour<br>--loadby mtime<br>--reverse<br>
</pre>
<p>
  <br>
  <br>
  For example running the specs on my current project I get this output.<br>
  <br>
</p>
<pre class="old_code">
<br>Profiling enabled.<br>........(a bunch more dots)<br><br>Top 10 slowest examples:<br>2.4908950 WikiContent should find all activity for a user<br>0.8061750 WikiContent should find recent activity for a user in last 15 days<br>0.2438460 WikiContent::Version should allow limit on results from finding recent activity<br>0.1821710 User should have a list of owned content<br>0.1700670 WikiContent should find results if access type is not same as role of the user but role of user is 'Leader'<br>0.1593900 ContentsController allows PUT request to 'update' action for 'member' role<br>0.1514150 Search::SearchResponse gets the wiki content id of an asset from the xml response<br>0.1470310 Content should always allow leaders to see all pages<br>0.1394920 Page should delete all comments when destroyed<br>0.1370330 ContentsController should save content and create the uploaded asset on successful POST to the 'create' action<br>
</pre>
<p>
  <br>
  <br>
  Over the next few days I will find time to take a look at 'WikiContent find all activity' and 'WikiContent find recent activity' specs as they are the two clear outliers.<br>
  <br>
  I now have no excuse to not optimize my slowest specs because I didn't know which they were!
</p>

  </div>

  <div id="disqus_thread"></div>
  <script type="text/javascript" src="http://alexrothenberg.disqus.com/embed.js"> </script>
  <noscript>Please enable JavaScript to <a href="http://alexrothenberg.disqus.com/?url=ref">view the discussion thread.</a></noscript>
</div>
  </div>

  <div id='footer'>
    Copyright &copy; 2011 Alex Rothenberg. Some rights reserved.
  </div>

</div>

<!-- Google Analytics -->
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-5273122-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
<!-- Google Analytics end -->


</body>
</html>
